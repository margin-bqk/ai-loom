# LOOM 环境变量配置示例
# 复制此文件为 .env 并填写实际值

# ====================
# LLM 提供商配置
# ====================

# OpenAI
OPENAI_API_KEY=sk-your-openai-api-key-here
OPENAI_BASE_URL=https://api.openai.com/v1  # 可选，用于自定义端点
OPENAI_MODEL=gpt-4-turbo-preview  # 默认模型

# Anthropic
ANTHROPIC_API_KEY=your-anthropic-api-key-here
ANTHROPIC_MODEL=claude-3-opus-20240229

# Ollama (本地运行)
OLLAMA_BASE_URL=http://localhost:11434
OLLAMA_MODEL=llama2

# Google Gemini
GOOGLE_API_KEY=your-google-api-key-here
GOOGLE_MODEL=gemini-pro

# Azure OpenAI
AZURE_OPENAI_API_KEY=your-azure-openai-key
AZURE_OPENAI_ENDPOINT=https://your-resource.openai.azure.com/
AZURE_OPENAI_DEPLOYMENT=gpt-4

# ====================
# 数据库配置
# ====================

# SQLite 数据库路径（默认：内存数据库）
DATABASE_URL=sqlite+aiosqlite:///loom.db
# 或使用 PostgreSQL
# DATABASE_URL=postgresql+asyncpg://user:password@localhost/loom

# 向量存储配置
VECTOR_STORE_TYPE=chroma  # chroma, pinecone, weaviate
CHROMA_PATH=./chroma_db

# ====================
# 会话配置
# ====================

# 默认会话存储路径
SESSION_STORAGE_PATH=./sessions

# 最大并发会话数
MAX_CONCURRENT_SESSIONS=10

# 会话超时（秒）
SESSION_TIMEOUT=3600

# ====================
# 日志配置
# ====================

# 日志级别：DEBUG, INFO, WARNING, ERROR
LOG_LEVEL=INFO

# 日志文件路径
LOG_FILE=./logs/loom.log

# 是否启用 JSON 格式日志
LOG_JSON=false

# ====================
# 缓存配置
# ====================

# LLM 响应缓存（秒，0 表示禁用）
LLM_CACHE_TTL=300

# 规则解析缓存（秒）
RULE_CACHE_TTL=60

# ====================
# 性能配置
# ====================

# 最大重试次数
MAX_RETRIES=3

# 请求超时（秒）
REQUEST_TIMEOUT=30

# 批处理大小
BATCH_SIZE=10

# ====================
# 安全配置
# ====================

# API 密钥（用于 Web API）
API_SECRET_KEY=change-this-in-production

# CORS 允许的来源
CORS_ALLOWED_ORIGINS=http://localhost:3000,http://127.0.0.1:3000

# ====================
# 开发配置
# ====================

# 模拟模式（不实际调用 LLM）
SIMULATE_MODE=false

# 调试模式
DEBUG=false

# 测试模式
TESTING=false

# ====================
# 阶段1重构新增配置
# ====================

# 叙事解释器模式：basic, advanced, creative
NARRATIVE_INTERPRETER_MODE=advanced

# 一致性检查强度：low, medium, high
CONSISTENCY_CHECK_LEVEL=medium

# 记忆存储类型：sqlite, postgres, memory
MEMORY_STORAGE_TYPE=sqlite

# 干预处理模式：strict, lenient, adaptive
INTERVENTION_HANDLING_MODE=adaptive

# 性能监控：true/false
ENABLE_PERFORMANCE_MONITORING=true

# 指标导出端口
METRICS_EXPORT_PORT=8001

# ====================
# 示例配置
# ====================

# 示例规则路径
EXAMPLE_CANON_PATH=./examples/basic_world.md

# 示例会话名称
EXAMPLE_SESSION_NAME=示例冒险

# 示例干预模式
EXAMPLE_INTERVENTION_MODE=guided
